#!/bin/bash
# Use this for your user data (script without newlines)
# install httpd (linux 2 version)
yum update -y
yum install -y httpd.x86_64
systemctl enable httpd.service
systemctl enable httpd.service
echo "Hello World from $(hostname -f)" > /var/www/html/index.html 



cat <<EOF | kubectl apply -f -
apiVersion: certificates.k8s.io/v1
kind: CertificateSigningRequest
metadata:
  name: akshay
spec:
  request: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURSBSRVFVRVNULS0tLS0KTUlJQ1ZqQ0NBVDRDQVFBd0VURVBNQTBHQTFVRUF3d0dZV3R6YUdGNU1JSUJJakFOQmdrcWhraUc5dzBCQVFFRgpBQU9DQVE4QU1JSUJDZ0tDQVFFQXQ5bENUYjUwQW1ZS3BoTnhKTi9tYjJKMFBIRE9odDBLVDZQc0Ryd0lhOVhHCno1Rjh1V204R29NbHdjM0xveFpQMS95QXJkQ3R3WjlqVzlkTEZySDdxeURrMG5iTlJ5aDdLYjNiSXR4Z0haR2sKNWh4VGw4dUlQaURLSmRDa2gvUEMyd1IzMUJHWUpwVEkza0psV1ZSbXR5WTRpZ2o4SXBoYVYvNXMrMUpNTGFDZgoxNmJIYTZVM1hlakMrRW1yaTl4Qnh1THJYUHhvRTc2T1BVWmo3VktUUmVHZDlJWUNHWGdFMGlNNVJUUWtGalRHCnRhNVZlTnc3WTNJYUNZaXRqRi94NGJBTGoxMnRDK0xTL1Q0R0dSNWJtOFc5SmMrbTAya0tqbVVHeEw4YkdYVUYKbUlOL1kwWGR1ZUlQWXZZd014NmJrZ1B0bzVSa3BsSnVyVzdNcklZSSt3SURBUUFCb0FBd0RRWUpLb1pJaHZjTgpBUUVMQlFBRGdnRUJBR1lIaTdnYUJXd0JmTnlqeVdvaGxCSWFRcGV2c3JXaUhOOTlhZldZOFZLV2grUnhRM2xpCnVSRXd0TitObWk3OFZ3NFVMeS92Z1YrZXVvQWZtb0h6QjdGZnFiYVQvaURZOVhFamhLWkswayt3RXkxNEIvcW0KdUlHTHFLc0pIWW5qeFhheHlxSDRGQXBXS0d0YVI4S3NqU1BtVnVmVUJSZVVzMlZjMHpiQ2EyamNpUGZJQS9BUQp3VkZzZWo5VU1qeHBBTXVHUXFmN3NQM0pYM0hEUHJpN3VGcWlOc1dSWU9DNXA2VTBZWWtCYkNSZUM2T0k0dU4wCjRQY2M5ZWJxZTJBb053QUdOS01Xc1JMbHBidHNGS2JKS1Zmcnk2bHUzRDhEcTRUK2JobzhlWlEyRkt3cnpvWngKbnhCRWlJT1g3dU5jbFYyQ2dOOFc0a0xwalMxRmJLRmNTaVU9Ci0tLS0tRU5EIENFUlRJRklDQVRFIFJFUVVFU1QtLS0tLQo=
  signerName: kubernetes.io/kube-apiserver-client
  usages:
  - client auth
EOF